SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE BANK_ACCOUNT;
DROP TABLE BONUS_RECORD;
DROP TABLE GOLD_TRANS_DETAIL;
DROP TABLE MESSAGE_BOX;
DROP TABLE NOTIC;
DROP TABLE SECURED_TRAN;
DROP TABLE USERS;




/* Create Tables */

CREATE TABLE BANK_ACCOUNT
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	ACCOUNT VARCHAR(50) NOT NULL COMMENT '账号',
	-- 0:否
	-- 1:是默认
	IS_DEF SMALLINT DEFAULT 0 NOT NULL COMMENT '是否默认',
	BANK_NAME VARCHAR(50) NOT NULL COMMENT '开户银行',
	USER_ID BIGINT NOT NULL COMMENT 'user_id',
	PRIMARY KEY (ID)
) COMMENT = '收款银行账号';


CREATE TABLE BONUS_RECORD
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	USER_ID BIGINT NOT NULL COMMENT '玩家id',
	-- 0:市场分红
	-- 1:领导奖
	-- 2:报单奖
	BONUS_TYPE SMALLINT DEFAULT 0 NOT NULL COMMENT '奖金类型',
	GOLD_COINS FLOAT NOT NULL COMMENT '增加金币数',
	GOLD_SEEDS FLOAT DEFAULT 0 NOT NULL COMMENT '金种子增加数',
	LJ FLOAT DEFAULT 0 NOT NULL COMMENT '累计增加',
	CREATE_TIME DATETIME NOT NULL COMMENT '创建时间',
	PRIMARY KEY (ID)
) COMMENT = '奖金记录';


CREATE TABLE GOLD_TRANS_DETAIL
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	CREATE_TIME DATETIME NOT NULL COMMENT '创建时间',
	AUGMENT  FLOAT COMMENT '增加',
	LESSEN FLOAT COMMENT '减少',
	REMARK VARCHAR(50) COMMENT '备注',
	USER_ID BIGINT NOT NULL COMMENT 'user_id',
	PRIMARY KEY (ID)
) COMMENT = '金币交易明细';


CREATE TABLE MESSAGE_BOX
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	USER_ID BIGINT NOT NULL COMMENT '玩家id',
	TITLE VARCHAR(50) NOT NULL COMMENT '标题',
	CONTENT TEXT NOT NULL COMMENT '内容',
	CREATE_TIME DATETIME NOT NULL COMMENT '创建时间',
	REPLY TEXT COMMENT '回复',
	REPLY_TIME DATETIME COMMENT '回复时间',
	-- 0:未关闭
	-- 1:已关闭
	STATUS SMALLINT COMMENT '状态',
	PRIMARY KEY (ID)
) COMMENT = '留言，私人邮箱';


CREATE TABLE NOTIC
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	-- 0:公告
	-- 1:常见问题
	TYPE SMALLINT DEFAULT 0 NOT NULL COMMENT '类别',
	TITLE VARCHAR(50) NOT NULL COMMENT '标题',
	CONTENT TEXT NOT NULL COMMENT '内容',
	CREATER_ID BIGINT NOT NULL COMMENT '创建人',
	CREATE_TIME DATETIME NOT NULL COMMENT '创建时间',
	PRIMARY KEY (ID)
) COMMENT = '公告通知';


CREATE TABLE SECURED_TRAN
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	AMT FLOAT DEFAULT 0 NOT NULL COMMENT '金币金额',
	REMARK VARCHAR(50) COMMENT '备注',
	BUY_USER_ID BIGINT NOT NULL COMMENT '买家玩家',
	SALE_USER_ID BIGINT NOT NULL COMMENT '卖出玩家',
	CREATE_TIME DATETIME NOT NULL COMMENT '创建时间',
	-- 0:未接收
	-- 1:已接收
	IS_RECV SMALLINT DEFAULT 0 NOT NULL COMMENT '买家是否接收',
	-- 0：担保
	-- 1：抢购
	-- 2：转账
	TRANS_TYPE SMALLINT DEFAULT 0 NOT NULL COMMENT '交易类型',
	PRIMARY KEY (ID)
) COMMENT = '担保交易';


CREATE TABLE USERS
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	REFEREE_ID BIGINT COMMENT '推荐玩家id',
	-- 0:
	-- 1:
	IS_M SMALLINT DEFAULT 0 NOT NULL COMMENT '是否管理用户',
	SN VARCHAR(20) NOT NULL UNIQUE COMMENT '编号',
	NICK_NAME VARCHAR(50) NOT NULL COMMENT '玩家昵称',
	REFEREE_SN VARCHAR(50) COMMENT '推荐玩家编号',
	-- 0:无级初学咋练
	-- 1:
	-- 2:
	-- 3:
	LEVEL SMALLINT DEFAULT 0 NOT NULL COMMENT '身份等级',
	QQ VARCHAR(0) COMMENT 'qq',
	CREDIT_INDEX SMALLINT DEFAULT 0 NOT NULL COMMENT '信用指数',
	-- 0:未激活
	-- 1:已激活
	STATUS SMALLINT DEFAULT 0 NOT NULL COMMENT '状态',
	-- 0:子帐号
	-- 1:主账号
	ACCOUNT_TYPE SMALLINT COMMENT '帐号类型',
	-- 0:否
	-- 1:是
	REPORT_CENTER SMALLINT DEFAULT 0 NOT NULL COMMENT '是否保单中心',
	PWD1 VARCHAR(50) NOT NULL COMMENT '一级密码',
	PWD2 VARCHAR(50) NOT NULL COMMENT '二级密码',
	LAST_LOGIN_TIME DATETIME COMMENT '上次登录时间',
	LAST_LOGIN_IP VARCHAR(50) COMMENT '上次登录ip',
	LOGIN_TIME DATETIME COMMENT '登录时间',
	LOGIN_IP VARCHAR(50) COMMENT '本次登录ip',
	LOGIN_COUNT INT DEFAULT 0 COMMENT '登录次数',
	IDENTITY_CARD VARCHAR(30) COMMENT '身份证号',
	SAFE_EMAIL VARCHAR(50) COMMENT '安全邮箱',
	GOLD_COIN FLOAT DEFAULT 0 COMMENT '金币',
	GOLD_SEEDS FLOAT DEFAULT 0 COMMENT '金种子',
	LSLJTC FLOAT DEFAULT 0 COMMENT '历史累计提成',
	LSLJFH FLOAT DEFAULT 0 COMMENT '历史累计分红',
	-- 0:未出局
	-- 1:已出局
	FHCJ SMALLINT DEFAULT 0 COMMENT '分红出局',
	BONUS_0 FLOAT DEFAULT 0 COMMENT '累计市场分红',
	BONUS_1 FLOAT DEFAULT 0 COMMENT '累计领导奖',
	BONUS_2 FLOAT DEFAULT 0 COMMENT '累计报单奖',
	REAL_NAME VARCHAR(20) COMMENT '真实姓名',
	PHONE VARCHAR(20) COMMENT '手机',
	PRIMARY KEY (ID)
) COMMENT = '用户';



/* Create Foreign Keys */

ALTER TABLE BANK_ACCOUNT
	ADD FOREIGN KEY (USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE BONUS_RECORD
	ADD FOREIGN KEY (USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE GOLD_TRANS_DETAIL
	ADD FOREIGN KEY (USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE MESSAGE_BOX
	ADD FOREIGN KEY (USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE NOTIC
	ADD FOREIGN KEY (CREATER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE SECURED_TRAN
	ADD FOREIGN KEY (BUY_USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE SECURED_TRAN
	ADD FOREIGN KEY (SALE_USER_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;


ALTER TABLE USERS
	ADD FOREIGN KEY (REFEREE_ID)
	REFERENCES USERS (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;



