SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Tables */

DROP TABLE SP_JBMEMBER;
DROP TABLE SP_JIUBANG;
DROP TABLE SP_WX_SCENE;




/* Create Tables */

CREATE TABLE SP_JBMEMBER
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	UNAME VARCHAR(50) COMMENT '姓名',
	JRTIME DATETIME NOT NULL COMMENT '加入时间',
	JBID BIGINT NOT NULL COMMENT '酒帮ID',
	-- 从SP_WX_USER表取
	WXUID BIGINT NOT NULL UNIQUE COMMENT '微信用户id',
	PRIMARY KEY (ID)
) COMMENT = '酒帮成员';


-- 必须购买了酒以后才开成为帮主。且只能创建一个帮。
CREATE TABLE SP_JIUBANG
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	JBNAME VARCHAR(50) UNIQUE COMMENT '酒帮名称',
	JBSN VARCHAR(50) UNIQUE COMMENT '酒帮编号',
	CTIME DATETIME NOT NULL COMMENT '创建时间',
	-- 从SP_WX_USER表取
	WXUID BIGINT NOT NULL UNIQUE COMMENT '微信用户id',
	PRIMARY KEY (ID)
) COMMENT = '酒帮';


CREATE TABLE SP_WX_SCENE
(
	ID BIGINT NOT NULL AUTO_INCREMENT COMMENT 'id',
	CTIME DATETIME COMMENT '创建时间',
	JBOPENID VARCHAR(50) COMMENT '酒帮主OPENID',
	PRIMARY KEY (ID)
) COMMENT = '二维码场景值';



/* Create Foreign Keys */

ALTER TABLE SP_JBMEMBER
	ADD FOREIGN KEY (JBID)
	REFERENCES SP_JIUBANG (ID)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;



