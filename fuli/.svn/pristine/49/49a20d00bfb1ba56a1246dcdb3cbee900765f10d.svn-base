<html>
<head>
	<title>古酿返利计算器</title>
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<script type="text/javascript">
	var consel_;
	var jj_=false;
	function fmoney(s, n) { 
		//n = n > 0 && n <= 20 ? n : 2; 
		s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + ""; 
		var l = s.split(".")[0].split("").reverse(), r = s.split(".")[1]; 
		t = ""; 
		for (i = 0; i < l.length; i++) { 
		t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : ""); 
		} 
		return t.split("").reverse().join("") + "." + r; 
	} 
	function jisuan(){
		var jishu_=document.getElementById("jishu").value;
		var price_=document.getElementById("price").value;
		var cys_=document.getElementById("cys").value;
		consel_=document.getElementById("consel");
		consel_.innerHTML="";
		var sale_total=fanli_total=0;
		var fanli_temp=0;//单个成员的返利；
		for (var i = 1; i<=jishu_; i++) {
			var n=Math.pow(cys_,jishu_-i);
			var sale=n;
			var fanli=0;
			fanli+=0.2;//第一次购买
				//帮主时获得的返利 计算帮主应该获得0.2
				if(i>1)
					fanli+=0.2*cys_;
			if(jj_==true&&i>1){
				//计算帮主再买一瓶酒 0.1
			//	sale+=n;
			//	fanli+=0.12;
			//	if(i>2)
				//帮主0.2返利
			//	fanli+=0.2*cys_;
				//再计算50%收益给帮主
				if(i<2){
					fanli+=0.2*0.5*cys_;
				}else{
					fanli+=fanli_temp*0.5*cys_;
				}
				fanli_temp=fanli;
			}
			sale_total+=sale;
			fanli_total+=fanli*n;

			printLog("第"+(jishu_-i+1)+"级人数："+n+"&nbsp;&nbsp;销售额："+(fmoney((sale*price_),2))+"&nbsp;&nbsp;每人返利："+(fmoney((fanli*price_),2))+"&nbsp;&nbsp;总返利："+(fmoney((fanli*n*price_),2)));
		}
		printLog("总销售量："+fmoney(sale_total,1)+"&nbsp;&nbsp;总销售额："+fmoney(sale_total*price_,2)+"&nbsp;&nbsp;总返利："+(fmoney((fanli_total*price_),2))+"&nbsp;&nbsp;结余："+(fmoney((sale_total-fanli_total)*price_,2)));
	}
	function printLog(v){
		consel_.innerHTML+="<br>"+v;
	}
	</script>
</head>
<body>
	级数
	<select id="jishu">
		<option value="20">20</option>
		<option value="19">19</option>
		<option value="18">18</option>
		<option value="17">17</option>
		<option value="16">16</option>
		<option value="15">15</option>
		<option value="14">14</option>
		<option value="13">13</option>
		<option value="12">12</option>
		<option value="11">11</option>
		<option value="10">10</option>
		<option value="9">9</option>
		<option value="8">8</option>
		<option value="7">7</option>
		<option value="6">6</option>
		<option value="5">5</option>
		<option value="4">4</option>
		<option value="3">3</option>
		<option value="2">2</option>
	</select>
	成员数
	<select id="cys">
		<option value="8">8</option>
		<option value="4">4</option>
		<option value="5">2</option>
		<option value="16">16</option>
	</select>
	价格<input id="price" value="268">元
	<input type="checkbox" id="jj" onclick="jj_=this.checked;">计算帮主奖金
	<button onclick="jisuan();">计算</button>
	<div id="consel" style="width:100%;height:500px;overflow:auto;">
		
	</div>
</body>
</html>